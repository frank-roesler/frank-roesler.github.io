<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    
    <title>Hobbyprojekte | Frank Rösler</title>
    <meta name="viewport" content="width=device-width,minimum-scale=1">
    <meta name="generator" content="Hugo 0.90.1" />
    
    
      <META NAME="ROBOTS" CONTENT="NOINDEX, NOFOLLOW">
    

    
    
      <link href="/dist/css/app.1cb140d8ba31d5b2f1114537dd04802a.css" rel="stylesheet">
    

    

    
      
    

    
    
    <meta property="og:title" content="Hobbyprojekte" />
<meta property="og:description" content="Modellierung von MRT-Pulsen Kernspinresonanz In der Magnetresonanztomographie (MRT) werden die Spins der Atomkerne in unserem Körper in ein starkes homogenes Magnetfeld $\mathsf{B_0}$ gebracht und durch einen Radiofrequenzpuls (RF) angeregt. Nach der Anregung rotieren die Spins gemeinsam in Phase und produzieren eine messbare makroskopische Magnetisierung $\mathsf{M(t)}$, die in der Zeit nach dem RF-Puls wieder zerfällt. Dieses messbare Signal wird in der MRT als &ldquo;free induction decay&rdquo; (FID) bezeichnet. Die Form des RF-Pulses ist zentral für die Kontrolle des angeregten Frequenzbereichs." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://frank-roesler.github.io/de/bloch/" /><meta property="article:section" content="" />
<meta property="article:published_time" content="2020-06-01T16:49:58+01:00" />
<meta property="article:modified_time" content="2020-06-01T16:49:58+01:00" />

<meta itemprop="name" content="Hobbyprojekte">
<meta itemprop="description" content="Modellierung von MRT-Pulsen Kernspinresonanz In der Magnetresonanztomographie (MRT) werden die Spins der Atomkerne in unserem Körper in ein starkes homogenes Magnetfeld $\mathsf{B_0}$ gebracht und durch einen Radiofrequenzpuls (RF) angeregt. Nach der Anregung rotieren die Spins gemeinsam in Phase und produzieren eine messbare makroskopische Magnetisierung $\mathsf{M(t)}$, die in der Zeit nach dem RF-Puls wieder zerfällt. Dieses messbare Signal wird in der MRT als &ldquo;free induction decay&rdquo; (FID) bezeichnet. Die Form des RF-Pulses ist zentral für die Kontrolle des angeregten Frequenzbereichs."><meta itemprop="datePublished" content="2020-06-01T16:49:58+01:00" />
<meta itemprop="dateModified" content="2020-06-01T16:49:58+01:00" />
<meta itemprop="wordCount" content="571">
<meta itemprop="keywords" content="" /><meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Hobbyprojekte"/>
<meta name="twitter:description" content="Modellierung von MRT-Pulsen Kernspinresonanz In der Magnetresonanztomographie (MRT) werden die Spins der Atomkerne in unserem Körper in ein starkes homogenes Magnetfeld $\mathsf{B_0}$ gebracht und durch einen Radiofrequenzpuls (RF) angeregt. Nach der Anregung rotieren die Spins gemeinsam in Phase und produzieren eine messbare makroskopische Magnetisierung $\mathsf{M(t)}$, die in der Zeit nach dem RF-Puls wieder zerfällt. Dieses messbare Signal wird in der MRT als &ldquo;free induction decay&rdquo; (FID) bezeichnet. Die Form des RF-Pulses ist zentral für die Kontrolle des angeregten Frequenzbereichs."/>

	
  </head>

  <body class="ma0 avenir bg-near-white">

    

  
  
  <header class="cover bg-top" style="background-image: url('https://frank-roesler.github.io/images/banner_blackboard2.jpg'); height: 200px;">
    <div class="pb3-m pb6-l bg-black-60" style="height: 200px;">
      <nav class="pv3 ph3 ph4-ns" role="navigation">
  <div class="flex-l justify-between items-center center">
    <a href="https://frank-roesler.github.io/" class="f3 fw2 hover-white no-underline white-90 dib">
      Frank Rösler
    </a>
    <div class="flex-l items-center">
      
      
        <ul class="pl0 mr3">
          
          <li class="list f5 f4-ns fw4 dib pr3">
            <a class="hover-white no-underline white-90" href="/de/" title="Home page">
              Home
            </a>
          </li>
          
          <li class="list f5 f4-ns fw4 dib pr3">
            <a class="hover-white no-underline white-90" href="/de/work/" title="Arbeit page">
              Arbeit
            </a>
          </li>
          
          <li class="list f5 f4-ns fw4 dib pr3">
            <a class="hover-white no-underline white-90" href="/de/research/" title="Mathematische Forschung page">
              Mathematische Forschung
            </a>
          </li>
          
          <li class="list f5 f4-ns fw4 dib pr3">
            <a class="hover-white no-underline white-90" href="/de/teaching/" title="Lehre page">
              Lehre
            </a>
          </li>
          
          <li class="list f5 f4-ns fw4 dib pr3">
            <a class="hover-white no-underline white-90" href="/de/cv/" title="CV page">
              CV
            </a>
          </li>
          
          <li class="list f5 f4-ns fw4 dib pr3">
            <a class="hover-white no-underline white-90" href="/de/links/" title="Links page">
              Links
            </a>
          </li>
          
          <li class="list f5 f4-ns fw4 dib pr3">
            <a class="hover-white no-underline white-90" href="/de/miscellaneous/" title="Hobbyprojekte page">
              Hobbyprojekte
            </a>
          </li>
          
          <li class="list f5 f4-ns fw4 dib pr3">
            <a class="hover-white no-underline white-90" href="/de/contact/" title="Kontakt page">
              Kontakt
            </a>
          </li>
          
        </ul>
      
	  
      







<a href="https://www.linkedin.com/in/frank-r%C3%B6sler-92ba241a0/?challengeId=AQGRWG6LDABMYQAAAXJgJkmswXXnWb9VNRJBaZ9Gq54XUuQprNLyCWIRKePEwAUX8PeGxR0Y9lmMjjBEuFRNyKz3786E_oeOMw&amp;submissionId=49642922-a07b-1316-1290-2b6baebd0d06" target="_blank" class="link-transition linkedin link dib z-999 pt3 pt0-l mr1" title="LinkedIn link" rel="noopener" aria-label="follow on LinkedIn——Opens in a new window">
  <svg  height="32px"  style="enable-background:new 0 0 65 65;" version="1.1" viewBox="0 0 65 65" width="32px" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
  <path d="M50.837,48.137V36.425c0-6.275-3.35-9.195-7.816-9.195  c-3.604,0-5.219,1.983-6.119,3.374V27.71h-6.79c0.09,1.917,0,20.427,0,20.427h6.79V36.729c0-0.609,0.044-1.219,0.224-1.655  c0.49-1.22,1.607-2.483,3.482-2.483c2.458,0,3.44,1.873,3.44,4.618v10.929H50.837z M22.959,24.922c2.367,0,3.842-1.57,3.842-3.531  c-0.044-2.003-1.475-3.528-3.797-3.528s-3.841,1.524-3.841,3.528c0,1.961,1.474,3.531,3.753,3.531H22.959z M34,64  C17.432,64,4,50.568,4,34C4,17.431,17.432,4,34,4s30,13.431,30,30C64,50.568,50.568,64,34,64z M26.354,48.137V27.71h-6.789v20.427  H26.354z" style="fill-rule:evenodd;clip-rule:evenodd;fill:;"/>
</svg>

<span class="new-window"><svg  height="8px"  style="enable-background:new 0 0 1000 1000;" version="1.1" viewBox="0 0 1000 1000" width="8px" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" >
<path d="M598 128h298v298h-86v-152l-418 418-60-60 418-418h-152v-86zM810 810v-298h86v298c0 46-40 86-86 86h-596c-48 0-86-40-86-86v-596c0-46 38-86 86-86h298v86h-298v596h596z" style="fill-rule:evenodd;clip-rule:evenodd;fill:;"/>
</svg>
</span></a>








	  
<h4></h4>
<ul class="pl0 mr3">
    
    <li class="list f5 f4-ns fw4 dib pr3">
        <a class="hover-white no-underline white-90" href="https://frank-roesler.github.io/bloch/" style="font-size:16px">en</a>
    </li>
    
</ul>


    </div>
  </div>
</nav>

      <div class="tc-l pv6 ph3 ph4-ns">
        
      </div>
    </div>
  </header>


	
    <main class="pb7" role="main">

	
	<head>
	<style>
		nav .narrow-dropdown {
		  display: none;
		  width: 100%;
		}
		@media (max-width: 960px) {
		  nav .side-menu     { display: none; }
		  nav .narrow-dropdown { display: inline-block; }
		}
		
		
		.menu-label {
			  list-style-type: none;
			  margin: 0;
			  padding: 0;
			  background-color: lightgray;
		 }
		
		li .menu-link {
			  display: block;
			  color: #000;
			  padding: 14px 36px;
			  text-decoration: none;
		}
		
		 
		li .menu-link:hover {
			  background-color: #555;
			  color: white;
		 }
		 
		 .side-menu {
			width: auto;
			margin-right:   3vh;
			margin-left:    3vh;
			margin-top:     3vh;
			margin-bottom:  5vh;
			font-size: 16px;
			float: left;
			 
			 
		}
	</style>
	
</head>


<nav> 
<ul class="side-menu">
	<li class="menu-label">
		<a  class="menu-link" href="/de/miscellaneous">Home</a>
	</li>
	<li class="menu-label">
		<a class="menu-link" href="/de/turing">Turing-Mechanismus</a>
	</li>
	<li class="menu-label">
		<a class="menu-link" href="/de/reconstruction">Bildrekonstruktion</a>
	</li>
	<li class="menu-label">
		<a class="menu-link" href="/de/flatten">Flatten the curve</a>
	</li>
	<li class="menu-label">
		<a class="menu-link" href="/de/sir">SIR-Modell Fit</a>
	</li>
	<li class="menu-label">
		<a class="menu-link" href="/de/perfdom">Perforierte Gebiete</a>
	</li>
	<li class="menu-label">
		<a class="menu-link" href="/de/segmentation">Bildsegmentierung</a>
	</li>
	<li class="menu-label">
		<a class="menu-link" href="/de/radon">Radon Transformation</a>
	</li>
	<li class="menu-label">
		<a class="menu-link" href="/de/reinforcement">Reinforcement Learning</a>
	</li>
	<li class="menu-label">
		<a class="menu-link" href="/de/gan">Generative Adversarial Network</a>
	</li>
	<li class="menu-label">
		<a class="menu-link" href="/de/denoising">Rauschunterdrückung</a>
	</li>
	<li class="menu-label">
		<a class="menu-link" href="/de/cs">Compressed Sensing</a>
	</li>
	<li class="menu-label">
		<a class="menu-link" href="/de/bloch">Modellierung von MRT Pulsen</a>
	</li>
	<li class="menu-label">
		<a class="menu-link" href="/de/bloch2">Deep Learning in MRT</a>
	</li>
	</ul>
	
	<form>
    <select class="narrow-dropdown" onchange="window.open(this.options[this.selectedIndex].value,'_self')">
        <option value="" selected="selected">Auswahl</option> 
		<option value="/de/miscellaneous">Home</option> 
		<option value="/de/turing">Turing-Mechanismus</option> 
		<option value="/de/reconstruction">Bildrekonstruktion</option> 
		<option value="/de/flatten">Flatten the curve</option> 
		<option value="/de/sir">SIR-Modell Fit</option>
		<option value="/de/perfdom">Perforierte Gebiete</option>
		<option value="/de/segmentation">Bildsegmentierung</option>
		<option value="/de/radon">Radon Transformation</option>
		<option value="/de/reinforcement">Reinforcement Learning</option>
		<option value="/de/gan">Generative Adversarial Network</option>
		<option value="/de/denoising">Rauschunterdrückung</option>
		<option value="/de/cs">Compressed Sensing</option>
		<option value="/de/bloch">Modellierung von MRT Pulsen</option>
		<option value="/de/bloch2">Deep Learning in MRT</option>
    </select>
	</form>
</nav>
	
	
	
	
	
		  
      
  <div class="flex-l mt2 mw8 center">
    <article class="center cf pv5 ph3 ph4-ns mw7">
      <header>
        <p class="f6 b helvetica tracked">
          
        </p>
        <h1 class="f1">
          Hobbyprojekte
        </h1>
      </header>
      <div class="nested-copy-line-height lh-copy f4 nested-links nested-img mid-gray">
        <!-- raw HTML omitted -->
<h2 id="modellierung-von-mrt-pulsen">Modellierung von MRT-Pulsen</h2>
<h4 id="kernspinresonanz">Kernspinresonanz</h4>
<p>In der Magnetresonanztomographie (MRT) werden die Spins der Atomkerne in unserem Körper in ein starkes homogenes Magnetfeld $\mathsf{B_0}$ gebracht und durch einen <a href="https://en.wikipedia.org/wiki/Physics_of_magnetic_resonance_imaging#Nuclear_magnetism">Radiofrequenzpuls (RF)</a> angeregt. Nach der Anregung rotieren die Spins gemeinsam in Phase und produzieren eine messbare makroskopische Magnetisierung $\mathsf{M(t)}$, die in der Zeit nach dem RF-Puls wieder zerfällt. Dieses messbare Signal wird in der MRT als &ldquo;free induction decay&rdquo; (FID) bezeichnet. Die Form des RF-Pulses ist zentral für die Kontrolle des angeregten Frequenzbereichs. Besonders wichtig ist die Fähigkeit, einen spezifischen, <a href="/bloch">schmalen Frequenzbereich anzuregen</a>. Tatsächlich ist dies zwingend notwendig, um die räumliche Information zu gewinnen, die letztendlich zu medizinisch nützlichen Bildern führt.<br>
Allerdings ist die Beziehung zwischen Form des RF-Pulses und der entsprechenden Frequenzantwort alles andere als einfach. Sie kann mathematisch modelliert werden durch die sogenannten <a href="https://de.wikipedia.org/wiki/Bloch-Gleichungen">Bloch-Gleichungen</a>:</p>
<p>$$\mathsf{\frac{d M_x(t)}{dt} = -\Delta\omega M_y(t) - \gamma B_{1,y}(t)M_z(t) - \frac{M_x(t)}{T_2}  }$$
$$\mathsf{\frac{d M_y(t)}{dt} = \Delta\omega M_x(t) + \gamma B_{1,x}(t)M_z(t) - \frac{M_y(t)}{T_2}  }$$
$$\mathsf{\frac{d M_z(t)}{dt} = \gamma B_{1,y}(t)M_x(t) - \gamma B_{1,x}(t)M_y(t) - \frac{M_z(t) - M_z^0}{T_1}  }.$$</p>
<p>Hierbei bezeichnet $\gamma$ eine physikalische Konstante, das <a href="https://de.wikipedia.org/wiki/Gyromagnetisches_Verh%C3%A4ltnis">gyromagnetische Verhältnis</a> und $\mathsf{B_1}$ das Magnetfeld des angelegten RF-Pulses. $\mathsf{\Delta\omega}$ bezeichnet die Abweichung von der <a href="https://de.wikipedia.org/wiki/Larmorpr%C3%A4zession">Larmorfrequenz</a> des Gewebes. Idealerweise sollte ein RF-Puls in der Lage sein, die Komponenten $\mathsf{M_x}$, $\mathsf{M_y}$, $\mathsf{M_z}$ nur in einem schmalen Bereich um $\mathsf{\Delta\omega=0}$ anzuregen.</p>
<h4 id="numerische-modellierung">Numerische Modellierung</h4>
<p>Die Bloch-Gleichungen lassen sich numerisch lösen. Eine der gängigen Lösungsmethoden habe ich in Python implementiert. Sie ermöglicht sowohl ein qualitatives, als auch ein quantitatives Verständnis von MRT-Sequenzen. Der Code ist open source und auf <a href="https://github.com/frank-roesler/bloch_solver">github.com/frank-roesler/bloch_solver</a> frei verfügbar. Die folgende Grafik illustriert den Effekt eines <a href="https://de.wikipedia.org/wiki/Sinc-Funktion">sinc-förmigen</a> RF-Pulses auf die Magnetisierung $\mathsf M$ für $\mathsf{\Delta\omega=0}$. Die Komponente $\mathsf{M_y}$ wird nach jedem Puls angeregt, wonach sie exponentiell zerfällt. Man beachte, dass der erste Puls (etwa zur Zeit 200ms) eine maximale Anregung erreicht (d.h. $\mathsf{M_y}=1$), wobei alle folgenden Pulse aufgrund der unvollständigen $\mathsf T_1$-Regeneration nur eine <em>teilweise</em> Anregung erreichen. Dies ist genau das Verhalten, das man theoretisch erwartet und in Messungen sieht. (siehe z.B. <a href="https://en.wikipedia.org/wiki/Physics_of_magnetic_resonance_imaging#Resonance_and_relaxation">hier</a>).</p>
<figure><a href="/images/bloch_figures/bloch.png"><img src="/images/bloch_figures/bloch.png"/></a>
</figure>

<h4 id="spin-echo-und-feldgradienten">Spin Echo und Feldgradienten</h4>
<p>Der Python-Code ermöglicht auch die qualitative Illustration von komplexeren MRT-Sequenzen. Die meisten modernen Sequenzen nutzen einen Effekt namens <a href="https://de.wikipedia.org/wiki/Spin-Echo">&ldquo;Spin Echo&rdquo;</a>. Dieser Effekt erlaubt es, den $\mathsf{T_2}$-Zerfall teilweise umzukehren, indem man RF-Pulse und magnetische Feldgradienten clever kombiniert. Die zentrale Idee besteht darin, die Spins, die durch ein inhomogenes Magnetfeld außer Phase geraten sind, wieder in eine Linie zu bringen. Dies kann entweder durch einen sogenannten 180º RF-Puls erreicht werden, oder durch zwei entgegengesetzte Feldgradienten. Das folgende Bild illustriert den ersten Fall. Ein erster Puls regt die Magnetisierung an, wonach sie durch Inhomogenitäten im Magnetfeld (hier einfachheitshalber modelliert durch einen konstanten Gradienten) wieder zerfällt. Nach einer Zeit $\mathsf{T_E/2}$ wird ein weiterer Puls (der 180º-Puls) angelegt. Die Numerik zeigt einen zweiten Peak in der Magnetisierung (orange), der zur Zeit $\mathsf{T_E}$ scheinbar aus dem Nichts entsteht. Dies wird in der MRT als &ldquo;Spin-Echo bezeichnet&rdquo;.</p>
<figure><a href="/images/bloch_figures/spin_echo.png"><img src="/images/bloch_figures/spin_echo.png"/></a>
</figure>

<p>Der zweite Fall, das &ldquo;Gradientenecho&rdquo;, ist im letzten Bild unten illustriert. Anstatt eines zweiten RF-Pulses wird hier ein magnetischer Feldgradient angelegt, erst in positive Richtung, dann in negative. Der erste (positive) Gradient verursacht eine Dephasierung der Spins, welche zu rapidem Signalverlust führt. Der zweite (negative) Gradient kehrt diesen Effekt um, verursacht also eine <em>Rephasierung</em>. Wie erwartet, kehrt das Signal während des zweiten Gradienten zurück (orangener Peak).</p>
<figure><a href="/images/bloch_figures/gradient_echo.png"><img src="/images/bloch_figures/gradient_echo.png"/></a>
</figure>

<p>All diese Effekte lassen sich an einem MRT-Gerät tatsächlich experimentell beobachten. Die Bloch-Gleichungen (zusammen mit ein bisschen Numerik) erlauben es uns, sie zu verstehen und vorherzusagen und alles, was wir dazu benötigen, ist ein Laptop!</p>

      </div>
    </article>
  </div>

    </main>
    <footer class="bg-gray bottom-0 w-100 pa3" role="contentinfo">
  <div class="flex justify-between">
  <a class="f4 fw4 hover-white no-underline white-70 dn dib-ns pv2 ph3" href="https://frank-roesler.github.io/" >
    &copy;  Frank Rösler 2023 
  </a>
    <div>







<a href="https://www.linkedin.com/in/frank-r%C3%B6sler-92ba241a0/?challengeId=AQGRWG6LDABMYQAAAXJgJkmswXXnWb9VNRJBaZ9Gq54XUuQprNLyCWIRKePEwAUX8PeGxR0Y9lmMjjBEuFRNyKz3786E_oeOMw&amp;submissionId=49642922-a07b-1316-1290-2b6baebd0d06" target="_blank" class="link-transition linkedin link dib z-999 pt3 pt0-l mr1" title="LinkedIn link" rel="noopener" aria-label="follow on LinkedIn——Opens in a new window">
  <svg  height="32px"  style="enable-background:new 0 0 65 65;" version="1.1" viewBox="0 0 65 65" width="32px" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
  <path d="M50.837,48.137V36.425c0-6.275-3.35-9.195-7.816-9.195  c-3.604,0-5.219,1.983-6.119,3.374V27.71h-6.79c0.09,1.917,0,20.427,0,20.427h6.79V36.729c0-0.609,0.044-1.219,0.224-1.655  c0.49-1.22,1.607-2.483,3.482-2.483c2.458,0,3.44,1.873,3.44,4.618v10.929H50.837z M22.959,24.922c2.367,0,3.842-1.57,3.842-3.531  c-0.044-2.003-1.475-3.528-3.797-3.528s-3.841,1.524-3.841,3.528c0,1.961,1.474,3.531,3.753,3.531H22.959z M34,64  C17.432,64,4,50.568,4,34C4,17.431,17.432,4,34,4s30,13.431,30,30C64,50.568,50.568,64,34,64z M26.354,48.137V27.71h-6.789v20.427  H26.354z" style="fill-rule:evenodd;clip-rule:evenodd;fill:;"/>
</svg>

<span class="new-window"><svg  height="8px"  style="enable-background:new 0 0 1000 1000;" version="1.1" viewBox="0 0 1000 1000" width="8px" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" >
<path d="M598 128h298v298h-86v-152l-418 418-60-60 418-418h-152v-86zM810 810v-298h86v298c0 46-40 86-86 86h-596c-48 0-86-40-86-86v-596c0-46 38-86 86-86h298v86h-298v596h596z" style="fill-rule:evenodd;clip-rule:evenodd;fill:;"/>
</svg>
</span></a>







</div>
  </div>
</footer>



<script>
MathJax = {
  tex: {
    inlineMath: [['$', '$'], ['\\(', '\\)']]
  }
};
</script>
<script id="MathJax-script" async
  src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js">
</script>

    

  <script src="/dist/js/app.3fc0f988d21662902933.js"></script>


  </body>
</html>

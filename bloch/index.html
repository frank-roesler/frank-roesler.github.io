<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    
    <title>Hobby Projects | Frank Rösler</title>
    <meta name="viewport" content="width=device-width,minimum-scale=1">
    <meta name="generator" content="Hugo 0.90.1" />
    
    
      <META NAME="ROBOTS" CONTENT="NOINDEX, NOFOLLOW">
    

    
    
      <link href="/dist/css/app.1cb140d8ba31d5b2f1114537dd04802a.css" rel="stylesheet">
    

    

    
      
    

    
    
    <meta property="og:title" content="Hobby Projects" />
<meta property="og:description" content="Modelling MRI Pulses Nuclear magnetic resonance In Magnetic Resonance Imaging (MRI) the nuclear spins in our body are placed in a strong homogeneous magnetic field $\mathsf{B_0}$ excited into a rotational state by radio frequency (RF) pulse. Once excited by an RF pulse, the nuclear spins rotate in phase, producing a measurable macroscopic magnetisation $\mathsf{ M(t)}$, which decays over time according to tissue-specific time scales called $\mathsf{T_1}$ and $\mathsf{T_2}$. This measurable signal is known in MRI as &ldquo;free induction decay&rdquo; (FID)." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://frank-roesler.github.io/bloch/" /><meta property="article:section" content="" />
<meta property="article:published_time" content="2020-06-01T16:49:58+01:00" />
<meta property="article:modified_time" content="2020-06-01T16:49:58+01:00" />

<meta itemprop="name" content="Hobby Projects">
<meta itemprop="description" content="Modelling MRI Pulses Nuclear magnetic resonance In Magnetic Resonance Imaging (MRI) the nuclear spins in our body are placed in a strong homogeneous magnetic field $\mathsf{B_0}$ excited into a rotational state by radio frequency (RF) pulse. Once excited by an RF pulse, the nuclear spins rotate in phase, producing a measurable macroscopic magnetisation $\mathsf{ M(t)}$, which decays over time according to tissue-specific time scales called $\mathsf{T_1}$ and $\mathsf{T_2}$. This measurable signal is known in MRI as &ldquo;free induction decay&rdquo; (FID)."><meta itemprop="datePublished" content="2020-06-01T16:49:58+01:00" />
<meta itemprop="dateModified" content="2020-06-01T16:49:58+01:00" />
<meta itemprop="wordCount" content="596">
<meta itemprop="keywords" content="" /><meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Hobby Projects"/>
<meta name="twitter:description" content="Modelling MRI Pulses Nuclear magnetic resonance In Magnetic Resonance Imaging (MRI) the nuclear spins in our body are placed in a strong homogeneous magnetic field $\mathsf{B_0}$ excited into a rotational state by radio frequency (RF) pulse. Once excited by an RF pulse, the nuclear spins rotate in phase, producing a measurable macroscopic magnetisation $\mathsf{ M(t)}$, which decays over time according to tissue-specific time scales called $\mathsf{T_1}$ and $\mathsf{T_2}$. This measurable signal is known in MRI as &ldquo;free induction decay&rdquo; (FID)."/>

	
  </head>

  <body class="ma0 avenir bg-near-white">

    

  
  
  <header class="cover bg-top" style="background-image: url('https://frank-roesler.github.io/images/banner_blackboard2.jpg'); height: 200px;">
    <div class="pb3-m pb6-l bg-black-60" style="height: 200px;">
      <nav class="pv3 ph3 ph4-ns" role="navigation">
  <div class="flex-l justify-between items-center center">
    <a href="https://frank-roesler.github.io/" class="f3 fw2 hover-white no-underline white-90 dib">
      Frank Rösler
    </a>
    <div class="flex-l items-center">
      
      
        <ul class="pl0 mr3">
          
          <li class="list f5 f4-ns fw4 dib pr3">
            <a class="hover-white no-underline white-90" href="/" title="Home page">
              Home
            </a>
          </li>
          
          <li class="list f5 f4-ns fw4 dib pr3">
            <a class="hover-white no-underline white-90" href="/research/" title="Research in Maths page">
              Research in Maths
            </a>
          </li>
          
          <li class="list f5 f4-ns fw4 dib pr3">
            <a class="hover-white no-underline white-90" href="/teaching/" title="Teaching page">
              Teaching
            </a>
          </li>
          
          <li class="list f5 f4-ns fw4 dib pr3">
            <a class="hover-white no-underline white-90" href="/cv/" title="CV page">
              CV
            </a>
          </li>
          
          <li class="list f5 f4-ns fw4 dib pr3">
            <a class="hover-white no-underline white-90" href="/links/" title="Links page">
              Links
            </a>
          </li>
          
          <li class="list f5 f4-ns fw4 dib pr3">
            <a class="hover-white no-underline white-90" href="/miscellaneous/" title="Hobby Projects page">
              Hobby Projects
            </a>
          </li>
          
          <li class="list f5 f4-ns fw4 dib pr3">
            <a class="hover-white no-underline white-90" href="/contact/" title="Contact page">
              Contact
            </a>
          </li>
          
        </ul>
      
	  
      







<a href="https://www.linkedin.com/in/frank-r%C3%B6sler-92ba241a0/?challengeId=AQGRWG6LDABMYQAAAXJgJkmswXXnWb9VNRJBaZ9Gq54XUuQprNLyCWIRKePEwAUX8PeGxR0Y9lmMjjBEuFRNyKz3786E_oeOMw&amp;submissionId=49642922-a07b-1316-1290-2b6baebd0d06" target="_blank" class="link-transition linkedin link dib z-999 pt3 pt0-l mr1" title="LinkedIn link" rel="noopener" aria-label="follow on LinkedIn——Opens in a new window">
  <svg  height="32px"  style="enable-background:new 0 0 65 65;" version="1.1" viewBox="0 0 65 65" width="32px" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
  <path d="M50.837,48.137V36.425c0-6.275-3.35-9.195-7.816-9.195  c-3.604,0-5.219,1.983-6.119,3.374V27.71h-6.79c0.09,1.917,0,20.427,0,20.427h6.79V36.729c0-0.609,0.044-1.219,0.224-1.655  c0.49-1.22,1.607-2.483,3.482-2.483c2.458,0,3.44,1.873,3.44,4.618v10.929H50.837z M22.959,24.922c2.367,0,3.842-1.57,3.842-3.531  c-0.044-2.003-1.475-3.528-3.797-3.528s-3.841,1.524-3.841,3.528c0,1.961,1.474,3.531,3.753,3.531H22.959z M34,64  C17.432,64,4,50.568,4,34C4,17.431,17.432,4,34,4s30,13.431,30,30C64,50.568,50.568,64,34,64z M26.354,48.137V27.71h-6.789v20.427  H26.354z" style="fill-rule:evenodd;clip-rule:evenodd;fill:;"/>
</svg>

<span class="new-window"><svg  height="8px"  style="enable-background:new 0 0 1000 1000;" version="1.1" viewBox="0 0 1000 1000" width="8px" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" >
<path d="M598 128h298v298h-86v-152l-418 418-60-60 418-418h-152v-86zM810 810v-298h86v298c0 46-40 86-86 86h-596c-48 0-86-40-86-86v-596c0-46 38-86 86-86h298v86h-298v596h596z" style="fill-rule:evenodd;clip-rule:evenodd;fill:;"/>
</svg>
</span></a>








	  
<h4></h4>
<ul class="pl0 mr3">
    
    <li class="list f5 f4-ns fw4 dib pr3">
        <a class="hover-white no-underline white-90" href="https://frank-roesler.github.io/de/bloch/" style="font-size:16px">de</a>
    </li>
    
</ul>


    </div>
  </div>
</nav>

      <div class="tc-l pv6 ph3 ph4-ns">
        
      </div>
    </div>
  </header>


	
    <main class="pb7" role="main">

	
		<head>
	<style>
		nav .narrow-dropdown {
		  display: none;
		  width: 100%;
		}
		@media (max-width: 960px) {
		  nav .side-menu     { display: none; }
		  nav .narrow-dropdown { display: inline-block; }
		}
		
		
		.menu-label {
			  list-style-type: none;
			  margin: 0;
			  padding: 0;
			  background-color: lightgray;
		 }
		
		li .menu-link {
			  display: block;
			  color: #000;
			  padding: 14px 28px;
			  text-decoration: none;
		}
		
		 
		li .menu-link:hover {
			  background-color: #555;
			  color: white;
		 }
		 
		 .side-menu {
			width: auto;
			margin-right:   3vh;
			margin-left:    3vh;
			margin-top:     3vh;
			margin-bottom:  5vh;
			font-size: 16px;
			float: left;
			 
			 
		}
	</style>
	
</head>

<nav> 
	<ul class="side-menu">
		<li class="menu-label">
			<a class="menu-link" href="/miscellaneous">Home</a>
		</li>
		<li class="menu-label">
			<a class="menu-link" href="/turing">Turing pattern</a>
		</li>
		<li class="menu-label">
			<a class="menu-link" href="/reconstruction">Image reconstruction</a>
		</li>
		<li class="menu-label">
			<a class="menu-link" href="/flatten">Flatten the curve</a>
		</li>
		<li class="menu-label">
		<a class="menu-link" href="/sir">SIR model fit</a>
		</li>
		<li class="menu-label">
			<a class="menu-link" href="/perfdom">Perforated Domains</a>
		</li>
		<li class="menu-label">
			<a class="menu-link" href="/segmentation">Image Segmentation</a>
		</li>
		<li class="menu-label">
			<a class="menu-link" href="/radon">Radon Transform</a>
		</li>
		<li class="menu-label">
			<a class="menu-link" href="/reinforcement">Reinforcement Learning</a>
		</li>
		<li class="menu-label">
			<a class="menu-link" href="/gan">Generative Adversarial Network</a>
		</li>
		<li class="menu-label">
			<a class="menu-link" href="/denoising">Denoising via ML</a>
		</li>
		<li class="menu-label">
			<a class="menu-link" href="/cs">Compressed Sensing</a>
		</li>
		<li class="menu-label">
			<a class="menu-link" href="/bloch">Modelling MRI Pulses</a>
		</li>
		<li class="menu-label">
			<a class="menu-link" href="/bloch2">Deep Learning in MRI</a>
		</li>
	</ul>
	
	<form>
    <select class="narrow-dropdown" onchange="window.open(this.options[this.selectedIndex].value,'_self')">
        <option value="" selected="selected">Select</option> 
		<option value="/miscellaneous">Home</option> 
		<option value="/turing">Turing</option> 
		<option value="/reconstruction">Image reconstruction</option> 
		<option value="/flatten">Flatten the curve</option> 
		<option value="/sir">SIR model fit</option>
		<option value="/perfdom">Perforated Domains</option>
		<option value="/segmentation">Image Segmentation</option>
		<option value="/radon">Radon Transform</option>
		<option value="/reinforcement">Reinforcement Learning</option>
		<option value="/gan">Generative Adversarial Network</option>
		<option value="/denoising">Denoising via ML</option>
		<option value="/cs">Compressed Sensing</option>
		<option value="/bloch">Modelling MRI Pulses</option>
		<option value="/bloch2">Deep Learning in MRI</option>
    </select>
	</form>
</nav>
	
	
	
	
	
		  
      
  <div class="flex-l mt2 mw8 center">
    <article class="center cf pv5 ph3 ph4-ns mw7">
      <header>
        <p class="f6 b helvetica tracked">
          
        </p>
        <h1 class="f1">
          Hobby Projects
        </h1>
      </header>
      <div class="nested-copy-line-height lh-copy f4 nested-links nested-img mid-gray">
        <h2 id="modelling-mri-pulses">Modelling MRI Pulses</h2>
<h4 id="nuclear-magnetic-resonance">Nuclear magnetic resonance</h4>
<p>In Magnetic Resonance Imaging (MRI) the nuclear spins in our body are placed in a strong homogeneous magnetic field $\mathsf{B_0}$ excited into a rotational state by <a href="https://en.wikipedia.org/wiki/Physics_of_magnetic_resonance_imaging#Nuclear_magnetism">radio frequency (RF) pulse</a>. Once excited by an RF pulse, the nuclear spins rotate in phase, producing a measurable macroscopic magnetisation $\mathsf{ M(t)}$, which decays over time according to tissue-specific time scales called $\mathsf{T_1}$ and $\mathsf{T_2}$. This measurable signal is known in MRI as &ldquo;free induction decay&rdquo; (FID). The shape of the RF pulse is crucial in determining the frequency range to be excited. In MRI, the ability to excite only a specific, narrow frequency range <a href="/bloch">is crucial</a>. In fact, this is necessary in order to obtain spatial information, which can finally result in medically useful images.<br>
However, the relationship between the shape of the pulse and the corresponding frequency response is far from trivial. It can be modeled mathematically by the so-called <a href="https://en.wikipedia.org/wiki/Bloch_equations">Bloch Equations</a>:</p>
<p>$$\mathsf{\frac{d M_x(t)}{dt} = -\Delta\omega M_y(t) - \gamma B_{1,y}(t)M_z(t) - \frac{M_x(t)}{T_2}  }$$
$$\mathsf{\frac{d M_y(t)}{dt} = \Delta\omega M_x(t) + \gamma B_{1,x}(t)M_z(t) - \frac{M_y(t)}{T_2}  }$$
$$\mathsf{\frac{d M_z(t)}{dt} = \gamma B_{1,y}(t)M_x(t) - \gamma B_{1,x}(t)M_y(t) - \frac{M_z(t) - M_z^0}{T_1}  }.$$</p>
<p>Here, $\gamma$ is a physical constant known as the <a href="https://en.wikipedia.org/wiki/Gyromagnetic_ratio">gyromagnetic ratio</a> and $\mathsf{B_1}$ is the magnetic field corresponding to the applied RF pulse. Moreover, $\mathsf{\Delta\omega}$ denotes the deviation in frequency from the <a href="https://en.wikipedia.org/wiki/Larmor_precession#Larmor_frequency">Larmor frequency</a> of the tissue. Ideally, a RF pulse should be able to excite $\mathsf{M_x}$, $\mathsf{M_y}$, $\mathsf{M_z}$ only in a narrow band around $\mathsf{\Delta\omega=0}$.</p>
<h4 id="numerical-modelling">Numerical modelling</h4>
<p>I have written a numerical solver for the Bloch equations in Python, which allows to understand both qualitative and quantitative features of MR pulse sequences. The code is open source and available on <a href="https://github.com/frank-roesler/bloch_solver">github.com/frank-roesler/bloch_solver</a>. The following figure illustrates the on-resonance effect ($\mathsf{\Delta\omega=0}$) of a <a href="https://en.wikipedia.org/wiki/Sinc_function">sinc shaped</a> RF pulse on the magnetisation $\mathsf M$. The component $\mathsf{M_y}$ gets excited after each of the pulses, after which it decays exponentially. Observe how the first pulse achieves maximal excitation (i.e. $\mathsf{M_y}=1$), while all subsequent pulses only achieve partial excitation (right hand plot), due to incomplete $\mathsf T_1$ recovery. This is exactly what is expected theoretically and observed experimentally (see <a href="https://en.wikipedia.org/wiki/Physics_of_magnetic_resonance_imaging#Resonance_and_relaxation">here</a>, for example).</p>
<figure><a href="/images/bloch_figures/bloch.png"><img src="/images/bloch_figures/bloch.png"/></a>
</figure>

<h4 id="spin-echo-and-field-gradients">Spin echo and field gradients</h4>
<p>The code can be used to explore more qualitative features of MRI pulse sequences. Most modern imaging sequences exploit an effect known as <a href="https://en.wikipedia.org/wiki/Spin_echo">&ldquo;spin echo&rdquo;</a>. This effect allows to partially reverse the $\mathsf{T_2}$ decay through clever usage of RF pulses and magnetic field gradients. The idea is to re-align nuclear spins that have gotten out of phase due to magnetic field inhomogeneities. This can either be achieved via a so-called 180º RF pulse, or through two opposite magnetic field gradients. The following figure illustrates the former case. An initial pulse excites the magnetisation, after which it decays due to field inhomogeneities (modeled here by a constant gradient, for simplicity). After a time $\mathsf{T_E/2}$ another pulse (the 180º pulse) is applied. The numerics shows another peak appearing seemingly out of nowhere at time $\mathsf{T_E}$ after initial excitation. This is known in MRI as &ldquo;spin echo&rdquo;.</p>
<figure><a href="/images/bloch_figures/spin_echo.png"><img src="/images/bloch_figures/spin_echo.png"/></a>
</figure>

<p>The latter case, known as &ldquo;gradient echo&rdquo;, is illustrated in the next figure. Here, rather than a second RF pulse, a magnetic field gradient is applied in two opposite directions. The initial gradient causes dephasing of the spins, leading to rapid signal decay, while the second gradient achieves a rephasing, which recovers the original signal.</p>
<figure><a href="/images/bloch_figures/gradient_echo.png"><img src="/images/bloch_figures/gradient_echo.png"/></a>
</figure>

<p>All these effects can be observed experimentally using actual MRI scanners. The Bloch equations and some basic numerics allow us to understand and predict them and all we need is a personal Laptop!</p>

      </div>
    </article>
  </div>

    </main>
    <footer class="bg-gray bottom-0 w-100 pa3" role="contentinfo">
  <div class="flex justify-between">
  <a class="f4 fw4 hover-white no-underline white-70 dn dib-ns pv2 ph3" href="https://frank-roesler.github.io/" >
    &copy;  Frank Rösler 2024 
  </a>
    <div>







<a href="https://www.linkedin.com/in/frank-r%C3%B6sler-92ba241a0/?challengeId=AQGRWG6LDABMYQAAAXJgJkmswXXnWb9VNRJBaZ9Gq54XUuQprNLyCWIRKePEwAUX8PeGxR0Y9lmMjjBEuFRNyKz3786E_oeOMw&amp;submissionId=49642922-a07b-1316-1290-2b6baebd0d06" target="_blank" class="link-transition linkedin link dib z-999 pt3 pt0-l mr1" title="LinkedIn link" rel="noopener" aria-label="follow on LinkedIn——Opens in a new window">
  <svg  height="32px"  style="enable-background:new 0 0 65 65;" version="1.1" viewBox="0 0 65 65" width="32px" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
  <path d="M50.837,48.137V36.425c0-6.275-3.35-9.195-7.816-9.195  c-3.604,0-5.219,1.983-6.119,3.374V27.71h-6.79c0.09,1.917,0,20.427,0,20.427h6.79V36.729c0-0.609,0.044-1.219,0.224-1.655  c0.49-1.22,1.607-2.483,3.482-2.483c2.458,0,3.44,1.873,3.44,4.618v10.929H50.837z M22.959,24.922c2.367,0,3.842-1.57,3.842-3.531  c-0.044-2.003-1.475-3.528-3.797-3.528s-3.841,1.524-3.841,3.528c0,1.961,1.474,3.531,3.753,3.531H22.959z M34,64  C17.432,64,4,50.568,4,34C4,17.431,17.432,4,34,4s30,13.431,30,30C64,50.568,50.568,64,34,64z M26.354,48.137V27.71h-6.789v20.427  H26.354z" style="fill-rule:evenodd;clip-rule:evenodd;fill:;"/>
</svg>

<span class="new-window"><svg  height="8px"  style="enable-background:new 0 0 1000 1000;" version="1.1" viewBox="0 0 1000 1000" width="8px" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" >
<path d="M598 128h298v298h-86v-152l-418 418-60-60 418-418h-152v-86zM810 810v-298h86v298c0 46-40 86-86 86h-596c-48 0-86-40-86-86v-596c0-46 38-86 86-86h298v86h-298v596h596z" style="fill-rule:evenodd;clip-rule:evenodd;fill:;"/>
</svg>
</span></a>







</div>
  </div>
</footer>



<script>
MathJax = {
  tex: {
    inlineMath: [['$', '$'], ['\\(', '\\)']]
  }
};
</script>
<script id="MathJax-script" async
  src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js">
</script>

    

  <script src="/dist/js/app.3fc0f988d21662902933.js"></script>


  </body>
</html>
